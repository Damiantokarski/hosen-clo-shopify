{{ 'section-hosen-products.css' | asset_url | stylesheet_tag }}

<div class="hosen-products color-{{ section.settings.color_scheme }}">
  <div class="hosen-products__container page-width">
    <div class="hosen-products__grid">
      {% for block in section.blocks %}
        {% assign product = block.settings.product %}
        {% if product != blank %}
          <div class="hosen-products__item" {{ block.shopify_attributes }}>
            <a href="{{ product.url }}" class="hosen-products__card">
              <div class="hosen-products__image-wrapper">
                {% if product.featured_image != blank %}
                  <img 
                    src="{{ product.featured_image | image_url: width: 800 }}"
                    srcset="{{ product.featured_image | image_url: width: 400 }} 400w,
                            {{ product.featured_image | image_url: width: 600 }} 600w,
                            {{ product.featured_image | image_url: width: 800 }} 800w"
                    sizes="(min-width: 990px) 33vw, (min-width: 750px) 50vw, 100vw"
                    alt="{{ product.featured_image.alt | default: product.title }}"
                    loading="lazy"
                    class="hosen-products__image hosen-products__image--primary"
                    width="{{ product.featured_image.width }}"
                    height="{{ product.featured_image.height }}"
                  >
                  {% if product.images[1] != blank %}
                    <img 
                      src="{{ product.images[1] | image_url: width: 800 }}"
                      srcset="{{ product.images[1] | image_url: width: 400 }} 400w,
                              {{ product.images[1] | image_url: width: 600 }} 600w,
                              {{ product.images[1] | image_url: width: 800 }} 800w"
                      sizes="(min-width: 990px) 33vw, (min-width: 750px) 50vw, 100vw"
                      alt="{{ product.images[1].alt | default: product.title }}"
                      loading="lazy"
                      class="hosen-products__image hosen-products__image--secondary"
                      width="{{ product.images[1].width }}"
                      height="{{ product.images[1].height }}"
                    >
                  {% endif %}
                {% else %}
                  <div class="hosen-products__placeholder">
                    {{ 'product-1' | placeholder_svg_tag: 'placeholder-svg' }}
                  </div>
                {% endif %}
                
                <div class="hosen-products__quick-view">
                  <span class="hosen-products__quick-view-text">QUICK VIEW</span>
                  <span class="hosen-products__quick-view-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <line x1="7" y1="17" x2="17" y2="7"></line>
                      <polyline points="7 7 17 7 17 17"></polyline>
                    </svg>
                  </span>
                </div>
              </div>
              
              <div class="hosen-products__info">
                {% if product.options_with_values.size > 0 %}
                  <div class="hosen-products__swatches">
                    {% for option in product.options_with_values %}
                      {% if option.name == 'Color' or option.name == 'Colour' or option.name == 'Kolor' %}
                        {% for value in option.values limit: 4 %}
                          <span class="hosen-products__swatch" style="background-color: {{ value | downcase }};" title="{{ value }}"></span>
                        {% endfor %}
                        {% if option.values.size > 4 %}
                          <span class="hosen-products__swatch-more">+{{ option.values.size | minus: 4 }}</span>
                        {% endif %}
                      {% endif %}
                    {% endfor %}
                  </div>
                {% endif %}
                
                {% if product.vendor != blank and section.settings.show_vendor %}
                  <span class="hosen-products__vendor">{{ product.vendor }}</span>
                {% endif %}
                
                <h3 class="hosen-products__title">{{ product.title }}</h3>
                
                <div class="hosen-products__price">
                  {% if product.compare_at_price > product.price %}
                    <span class="hosen-products__price--sale">{{ product.price | money }}</span>
                    <span class="hosen-products__price--compare">{{ product.compare_at_price | money }}</span>
                  {% else %}
                    <span class="hosen-products__price--regular">{{ product.price | money }}</span>
                  {% endif %}
                </div>
              </div>
            </a>
          </div>
        {% else %}
          <div class="hosen-products__item hosen-products__item--placeholder" {{ block.shopify_attributes }}>
            <div class="hosen-products__card">
              <div class="hosen-products__image-wrapper">
                <div class="hosen-products__placeholder">
                  {{ 'product-1' | placeholder_svg_tag: 'placeholder-svg' }}
                </div>
              </div>
              <div class="hosen-products__info">
                <span class="hosen-products__vendor">Brand name</span>
                <h3 class="hosen-products__title">Product title</h3>
                <div class="hosen-products__price">
                  <span class="hosen-products__price--regular">0,00 zł</span>
                </div>
              </div>
            </div>
          </div>
        {% endif %}
      {% endfor %}
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Hosen Products",
  "tag": "section",
  "class": "section-hosen-products",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "checkbox",
      "id": "show_vendor",
      "label": "Pokaż producenta",
      "default": true
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Schemat kolorów",
      "default": "scheme-1"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Górny padding",
      "default": 20
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Dolny padding",
      "default": 60
    }
  ],
  "blocks": [
    {
      "type": "product",
      "name": "Produkt",
      "settings": [
        {
          "type": "product",
          "id": "product",
          "label": "Wybierz produkt"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Hosen Products",
      "blocks": [
        {
          "type": "product"
        },
        {
          "type": "product"
        },
        {
          "type": "product"
        }
      ]
    }
  ]
}
{% endschema %}

{% style %}
  .section-hosen-products {
    --padding-top: {{ section.settings.padding_top }}px;
    --padding-bottom: {{ section.settings.padding_bottom }}px;
  }
{% endstyle %}
